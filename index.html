<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>HongWan</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous" />
  </head>
  <body>
    <main class="container-lg">
      <form id="form_translate" method="post" class="mt-3" accept-charset="utf-8">
        <div class="form-group row">
          <label for="hk" class="col-sm-2 col-form-label sr-only">粵語</label>
          <div class="col-md-5">
            <textarea id="from" rows="3" class="form-control"></textarea>
          </div>
          <div class="col-md-2 mt-2 mb-2 mt-md-0 mb-md-0 text-center">
            <button type="submit" class="btn btn-primary">提交</button>
          </div>
          <label for="to" class="col-sm-2 col-form-label sr-only">書面語</label>
          <div class="col-md-5">
            <textarea id="to" rows="3" class="form-control" readonly></textarea>
          </div>
        </div>
      </form>
    </main>
    <script>
      (function() {
        var list = [{"key":"𤷪","is_exceptional_case":[],"list":[{"from":"𤷪𤺧","to":"心情差"}]},{"key":"𢛴","is_exceptional_case":[],"list":[{"from":"𢛴憎","to":"心情差"}]},{"key":"䟴","is_exceptional_case":[],"list":[{"from":"䟴腳","to":"抖腿"}]},{"key":"䒐","is_exceptional_case":[],"list":[{"from":"䒐䒏","to":"心情差"}]},{"key":"點","is_exceptional_case":[],"list":[{"from":"點解","to":"為甚麼"},{"from":"點樣","to":"怎樣"}]},{"key":"馟","is_exceptional_case":[],"list":[{"from":"馟","to":"氣味"}]},{"key":"都","is_exceptional_case":[],"list":[{"from":"都係","to":"也是"}]},{"key":"邊","is_exceptional_case":[],"list":[{"from":"邊度","to":"哪裡"}]},{"key":"遴","is_exceptional_case":[],"list":[{"from":"遴迍","to":"笨手笨腳"}]},{"key":"輘","is_exceptional_case":[],"list":[{"from":"輘輷","to":"內情"}]},{"key":"躝","is_exceptional_case":[],"list":[{"from":"躝屍趷路","to":"滾"}]},{"key":"諗","is_exceptional_case":[],"list":[{"from":"諗","to":"想"}]},{"key":"該","is_exceptional_case":[],"list":[{"from":"該煨","to":"可憐"}]},{"key":"訓","is_exceptional_case":[],"list":[{"from":"訓覺","to":"睡覺"}]},{"key":"蠻","is_exceptional_case":[],"list":[{"from":"蠻倀","to":"心情差"}]},{"key":"蛇","is_exceptional_case":[],"list":[{"from":"蛇王","to":"偷懶"}]},{"key":"虢","is_exceptional_case":[],"list":[{"from":"虢礫緙嘞","to":"各式各樣"}]},{"key":"緊","is_exceptional_case":[],"list":[{"from":"緊係","to":"當然"}]},{"key":"約","is_exceptional_case":[],"list":[{"from":"約緊","to":"正在約"}]},{"key":"箍","is_exceptional_case":[],"list":[{"from":"箍煲","to":"破鏡重圓"}]},{"key":"穿","is_exceptional_case":[],"list":[{"from":"穿煲","to":"洩露了秘密"}]},{"key":"瞓","is_exceptional_case":[],"list":[{"from":"瞓覺","to":"睡覺"}]},{"key":"睇","is_exceptional_case":[],"list":[{"from":"睇","to":"看"}]},{"key":"痴","is_exceptional_case":[],"list":[{"from":"痴鬼線","to":"發神經"},{"from":"痴那線","to":"發神經"},{"from":"痴線","to":"發神經"},{"from":"痴撚線","to":"發神經"},{"from":"痴乸線","to":"發神經"}]},{"key":"畀","is_exceptional_case":[],"list":[{"from":"畀","to":"給"}]},{"key":"炒","is_exceptional_case":[],"list":[{"from":"炒魷魚","to":"解雇"},{"from":"炒車","to":"撞車"},{"from":"炒人魷魚","to":"解雇"},{"from":"炒人","to":"解雇員工"}]},{"key":"瀨","is_exceptional_case":[],"list":[{"from":"瀨晒嘢","to":"糟糕"},{"from":"瀨嘢","to":"糟糕"}]},{"key":"渣","is_exceptional_case":[],"list":[{"from":"渣流攤","to":"敷衍了事"}]},{"key":"毷","is_exceptional_case":[],"list":[{"from":"毷氉","to":"心情差"}]},{"key":"正","is_exceptional_case":[],"list":[{"from":"正仆街","to":"真是個混蛋"}]},{"key":"梗","is_exceptional_case":[],"list":[{"from":"梗係","to":"當然"}]},{"key":"朱","is_exceptional_case":[],"list":[{"from":"朱義盛","to":"假貨"}]},{"key":"有","is_exceptional_case":[],"list":[{"from":"有咩","to":"有嗎"},{"from":"有乜","to":"有甚麼"}]},{"key":"既","is_exceptional_case":[],"list":[{"from":"既野","to":"那些東西"},{"from":"既嘢","to":"那些東西"}]},{"key":"放","is_exceptional_case":[],"list":[{"from":"放喺","to":"放在"}]},{"key":"收","is_exceptional_case":[],"list":[{"from":"收嗲","to":"閉嘴"}]},{"key":"搵","is_exceptional_case":[],"list":[{"from":"搵","to":"找"}]},{"key":"揸","is_exceptional_case":[],"list":[{"from":"揸車","to":"駕車"}]},{"key":"懞","is_exceptional_case":[],"list":[{"from":"懞掙","to":"心情差"}]},{"key":"憫","is_exceptional_case":[],"list":[{"from":"憫憎","to":"心情差"}]},{"key":"忟","is_exceptional_case":[],"list":[{"from":"忟憎","to":"心情差"}]},{"key":"屌","is_exceptional_case":[],"list":[{"from":"屌","to":"幹"}]},{"key":"好","is_exceptional_case":[],"list":[{"from":"好𤷪𤺧","to":"心情好差"},{"from":"好𢛴憎","to":"心情好差"},{"from":"好䒐䒏","to":"心情好差"},{"from":"好蠻倀","to":"心情好差"},{"from":"好毷氉","to":"心情好差"},{"from":"好懞掙","to":"心情好差"},{"from":"好憫憎","to":"心情好差"},{"from":"好忟憎","to":"心情好差"}]},{"key":"大","is_exceptional_case":[],"list":[{"from":"大頭蝦","to":"笨笨的"}]},{"key":"囉","is_exceptional_case":[],"list":[{"from":"囉囉攣","to":"不安"}]},{"key":"嚟","is_exceptional_case":[],"list":[{"from":"嚟","to":"來"}]},{"key":"嘅","is_exceptional_case":[],"list":[{"from":"嘅野","to":"那些東西"},{"from":"嘅嘢","to":"那些東西"},{"from":"嘅","to":"的"}]},{"key":"嗰","is_exceptional_case":[],"list":[{"from":"嗰班","to":"那一群"},{"from":"嗰啲","to":"那些"}]},{"key":"喺","is_exceptional_case":[],"list":[{"from":"喺","to":"在"}]},{"key":"啲","is_exceptional_case":[],"list":[{"from":"啲","to":"一些"}]},{"key":"啱","is_exceptional_case":[],"list":[{"from":"啱","to":"對"}]},{"key":"唔","is_exceptional_case":[],"list":[{"from":"唔","to":"不"}]},{"key":"哋","is_exceptional_case":[],"list":[{"from":"哋","to":"們"}]},{"key":"咪","is_exceptional_case":[],"list":[{"from":"咪住","to":"等一等"}]},{"key":"咩","is_exceptional_case":[],"list":[{"from":"咩都","to":"甚麼都"}]},{"key":"呢","is_exceptional_case":[],"list":[{"from":"呢次","to":"這次"},{"from":"呢啲","to":"這些"},{"from":"呢個","to":"這個"}]},{"key":"去","is_exceptional_case":[],"list":[{"from":"去緊","to":"正在去"}]},{"key":"冚","is_exceptional_case":[],"list":[{"from":"冚家產","to":"該死的"},{"from":"冚唪唥","to":"全部"}]},{"key":"冇","is_exceptional_case":[],"list":[{"from":"冇","to":"無"}]},{"key":"俾","is_exceptional_case":[],"list":[{"from":"俾唔俾","to":"可不可以"},{"from":"俾唔俾","to":"可不可以"},{"from":"俾","to":"給"}]},{"key":"俹","is_exceptional_case":[],"list":[{"from":"俹簁","to":"得過且過"}]},{"key":"係","is_exceptional_case":[],"list":[{"from":"係","to":"是"}]},{"key":"依","is_exceptional_case":[],"list":[{"from":"依家","to":"現在"}]},{"key":"來","is_exceptional_case":[],"list":[{"from":"來路野","to":"外來貨"},{"from":"來路嘢","to":"外來貨"},{"from":"來路","to":"外來"},{"from":"來佬野","to":"外來貨"},{"from":"來佬嘢","to":"外來貨"},{"from":"來佬","to":"外來"}]},{"key":"佢","is_exceptional_case":[],"list":[{"from":"佢","to":"他"}]},{"key":"佗","is_exceptional_case":[],"list":[{"from":"佗佻","to":"輕鬆"}]},{"key":"似","is_exceptional_case":[],"list":[{"from":"似","to":"像"}]},{"key":"仲","is_exceptional_case":[],"list":[{"from":"仲要","to":"還要"}]},{"key":"仆","is_exceptional_case":[],"list":[{"from":"仆街仔","to":"混蛋"}]},{"key":"人","is_exceptional_case":[],"list":[{"from":"人哋","to":"他們"}]},{"key":"u","is_exceptional_case":[],"list":[{"from":"un腳","to":"抖腿"}]}],
            el_form_translate = document.getElementById('form_translate'),
            el_from = document.getElementById('from'),
            el_to = document.getElementById('to');

        el_form_translate.onsubmit = () => {
          var el_from_values = el_from.value.split("\n"),
              to_value = "",
              current_word = "",
              parent_node = null,
              key = "",
              matched_records = [],
              prev_matched_records = {
                word: null,
                records: []
              },
              translate_data = null,
              loop_limit_current = 0,
              loop_limit = 0;

          el_from_values.forEach((line, el_from_values_index) => {
            if (el_from_values_index > 0) {
              to_value += "\n";
            }

            loop_limit_current = 0;
            loop_limit = line.length;

            while (line.length > 0) {
              key = line.slice(current_word.length, current_word.length + 1);
              current_word = line.slice(0, current_word.length + 1);
              matched_records = [];
              translate_data = null;

              if (parent_node === null) {
                for (var i = 0, length = list.length; i < length; i++) {
                  if (list[i].key === key) {
                    parent_node = list[i];
                    break;
                  }
                }

                if (parent_node === null) {
                  to_value += current_word;
                  line = line.substr(current_word.length);
                  current_word = "";
                  continue;
                }
              }

              for (var i = 0, length = parent_node.list.length; i < length; i++) {
                if (parent_node.list[i].from.indexOf(current_word) !== -1) {
                  matched_records.push(parent_node.list[i]);
                }
              }

              if (matched_records.length > 0) {
                if (matched_records.length === 1 || line === current_word) {
                  for (var i = 0, length = matched_records.length; i < length; i++) {
                    if (matched_records[i].from === current_word) {
                      translate_data = getTranslateData(current_word, matched_records[i].to);
                      break;
                    }
                  }

                  if (line === current_word && translate_data === null) {
                    translate_data = getTranslateData(current_word, current_word);
                  }
                } 

                if (translate_data === null) {
                  prev_matched_records.word = current_word;
                  prev_matched_records.records = matched_records;
                }
              } else if (prev_matched_records.records.length > 0) {
                for (var i = 0, length = prev_matched_records.records.length; i < length; i++) {
                  if (prev_matched_records.records[i].from === prev_matched_records.word) {
                    translate_data = getTranslateData(prev_matched_records.word, prev_matched_records.records[i].to);
                    break;
                  }
                }

                if (translate_data === null) {
                  translate_data = getTranslateData(prev_matched_records.word, prev_matched_records.word);
                }
              }

              if (translate_data !== null) {
                line = line.substr(translate_data.original_word.length);
                to_value += translate_data.translated_word;
                current_word = "";

                parent_node = null;
                prev_matched_records.word = null;
                prev_matched_records.records = [];
                translate_data = null;
              }
            }
          });

          el_to.value = to_value;

          return false;
        };

        function getTranslateData(original_word, translated_word) {
          return {
            original_word: original_word,
            translated_word: translated_word
          };
        }
      })();
    </script>
  </body>
</html>
